0x52

high

# Tier winner can steal excess funds from percentage bounty if any deposits are expired

## Summary

Total funds used to calculate the percentage payment is set when the bounty is closed. If the main deposit is refundable by the time when the bounty is closed, a tier winner could exploit the bounty to steal all the funds in the contract.

Tier winner monitors mempool and sees transaction adding them as tier winner. They frontrun the transaction with funding call that adds a large amount of funds to the winning pool. This sets their payout much higher than it should be allowing them to get a much larger payout than intended. They then backrun the transaction adding the tier winner with a permissionedClaimTieredBounty to immediately claim their "portion" of the prize pool. The very next block they refund their deposit and reclaim their entire deposit, leaving the bounty empty.

## Vulnerability Detail

## Impact

## Code Snippet

## Tool used

Manual Review

## Recommendation
